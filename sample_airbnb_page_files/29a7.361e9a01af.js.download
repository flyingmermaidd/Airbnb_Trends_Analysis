__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.useGetWishlistItemIds=function(){const t=(0,u.useContext)(j);if(!t)throw new Error('useGetWishlistItemIds must be used within a SaveToListStoreProvider');return(0,u.useCallback)(((s,n)=>(0,M.getWishlistItemIds)(t.getState(),s,n)),[t])},e.useIsEntitySavedToAnyList=function(t,s){const n=(0,u.useContext)(j);if(!n)throw new Error('useIsEntitySavedToAnyList must be used within a SaveToListStoreProvider');const o=(0,u.useMemo)((()=>n=>!!s&&(0,M.isEntitySavedToAnyList)(n,t,s)),[s,t]);return(0,y.useStore)(n,o)},e.useIsEntitySavedToAnyListDeprecated=function(){const t=(0,u.useContext)(j);if(!t)throw new Error('useIsEntitySavedToAnyListDeprecated must be used within a SaveToListStoreProvider');const s=(0,u.useMemo)((()=>t=>t.wishlistItems),[]),n=(0,y.useStore)(t,s);return(0,u.useCallback)(((t,s)=>(0,M.isEntitySavedToAnyList)({wishlists:[],wishlistItems:n},t,s)),[n])},e.useMergeWishlistItems=function(t){const s=(0,u.useContext)(j);if(!s)throw new Error('useMergeWishlistSnapshot must be used within a SaveToListStoreProvider');(0,u.useEffect)((()=>{if(t&&t.length>0){const n={wishlists:[],wishlistItems:new Set(t.filter(b.default).map(C.createWishlistItemReplica))};s.merge(n)}}),[t,s])},e.useMutationsSettledEffect=function(t){const s=(0,u.useContext)(j);if(!s)throw new Error('useMutationsSettledEffect must be used within a SaveToListStoreProvider');const n=(0,y.useStore)(s.allMutationsSettledCount,y.identitySelector),o=(0,w.useEvent)(t);(0,u.useEffect)((()=>{n>0&&o()}),[o,n])},e.useSaveToListStoreDebugLogger=function({store:t}={}){const s=(0,o.useDebugLogger)('SaveToListStoreProvider'),n=(0,u.useContext)(j),l=t??n;(0,u.useEffect)((()=>l?.subscribe((t=>{s((()=>t))}))),[s,l])},e.useWishlistMutations=function(){const t=(0,u.useContext)(j);if(!t)throw new Error('useWishlistMutations must be used within a SaveToListStoreProvider');const[s]=(0,c().useMutation)(v.default),[n]=(0,c().useMutation)(f.default),[o]=(0,c().useMutation)(S.default);return{createWishlist:(0,u.useMemo)((()=>n=>t.createWishlist({mutate:s,options:n})),[s,t]),addWishlistItem:(0,u.useMemo)((()=>s=>t.addWishlistItem({mutate:n,options:s})),[n,t]),batchDeleteWishlistItems:(0,u.useMemo)((()=>s=>t.batchDeleteWishlistItems({mutate:o,options:s})),[o,t]),clear:t.clear}};var s=t(r(d[1])),n=t(r(d[2])),u=r(d[3]),o=r(d[4]),l=t(r(d[5])),h=r(d[6]);function c(){const t=r(d[7]);return c=function(){return t},t}var f=t(r(d[8])),S=t(r(d[9])),v=t(r(d[10])),w=r(d[11]),b=t(r(d[12])),p=r(d[13]),I=r(d[14]),M=r(d[15]),y=r(d[16]),C=r(d[17]);function W(){return{wishlists:[],wishlistItems:new Set}}var E=(0,n.default)("clientReplica"),L=(0,n.default)("mutationsQueue"),T=(0,n.default)("getStateCached"),P=(0,n.default)("getInitialStateCached"),_=(0,n.default)("broadcastChannel"),O=(0,n.default)("applyOptimisticUpdates");class x{constructor({initialSnapshot:t=W()}={}){Object.defineProperty(this,O,{value:D}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:void 0}),Object.defineProperty(this,T,{writable:!0,value:void 0}),Object.defineProperty(this,P,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),this.allMutationsSettledCount=void 0,(0,s.default)(this,_)[_]='BroadcastChannel'in window?new BroadcastChannel("save_to_list_partial_state"):null,(0,s.default)(this,E)[E]=new y.Store(t),(0,s.default)(this,L)[L]=new I.MutationQueue({onMutationAdded:()=>{this.merge({})},onMutationSettled:t=>{this.merge(t??{}),setTimeout((()=>{(0,s.default)(this,L)[L].hasPendingMutations()||this.allMutationsSettledCount.setState(this.allMutationsSettledCount.getState()+1)}),0);const n=h.Flagger.findTreatment((0,l.default)('wishlist_tenant_integration_web'));['async_only','treatment'].includes(n)&&(0,s.default)(this,_)[_]?.postMessage({partialState:t,version:1})}}),this.subscribe=this.subscribe.bind(this),this.getState=this.getState.bind(this),this.getInitialState=this.getInitialState.bind(this),this.clear=this.clear.bind(this),(0,s.default)(this,T)[T]=null,(0,s.default)(this,P)[P]=(0,p.removeVersioningMetadata)((0,s.default)(this,E)[E].getInitialState()),this.allMutationsSettledCount=new y.Store(0),(0,s.default)(this,_)[_]&&((0,s.default)(this,_)[_].onmessage=t=>{1===t.data.version&&t.data.partialState&&this.merge(t.data.partialState)})}getState(){return null==(0,s.default)(this,T)[T]&&((0,s.default)(this,T)[T]=(0,s.default)(this,O)[O]()),(0,s.default)(this,T)[T]}getInitialState(){return(0,s.default)(this,P)[P]}subscribe(t){return(0,s.default)(this,E)[E].subscribe((()=>t(this.getState())))}merge(t){(0,s.default)(this,T)[T]=null,(0,s.default)(this,E)[E].setState((0,p.merge)((0,s.default)(this,E)[E].getState(),t))}createWishlist(t){return(0,s.default)(this,L)[L].createWishlist(t)}addWishlistItem(t){return(0,s.default)(this,L)[L].addWishlistItem(t)}batchDeleteWishlistItems(t){return(0,s.default)(this,L)[L].batchDeleteWishlistItems(t)}clear(){(0,s.default)(this,T)[T]=null,(0,s.default)(this,E)[E].setState((0,s.default)(this,E)[E].getInitialState())}}function D(){return(0,s.default)(this,L)[L].applyOptimisticUpdates((0,s.default)(this,E)[E].getState())}const j=(0,u.createContext)((function(){const t=window.saveToListStore||new x;return window.saveToListStore=t,t})())}),"10c8a3",["ba7a76","76718e","99527b","07aa1f","f8ea9a","4d3544","dcc72a","068abc","bd6cf7","f9f96a","d7b2e2","f4e9c4","58861b","e06512","957ea8","3e7627","d0f410","1b9467"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,u){const{location:{search:s}}=window,{adults:f=0,infants:h=0,children:o=0,pets:k=0,checkin:p,checkout:_,check_in:I,check_out:y,flexible_date_search_filter_type:O,flexible_days:b}=n().default.parse(s,{ignoreQueryPrefix:!0}),x=t?null:I||p,v=t?null:y||_,D={adults:parseInt(f,10),infants:parseInt(h,10),children:parseInt(o,10),pets:parseInt(k,10),checkIn:x&&(0,c.default)(x).isValid()?(0,c.default)(x).format(l):null,checkOut:v&&(0,c.default)(v).isValid()?(0,c.default)(v).format(l):null,flexibleDateSearchFilterType:null==O?void 0:parseInt(O,10),flexibleDays:b};return{...D,...u,checkIn:t?D.checkIn:u?.checkIn??D.checkIn,checkOut:t?D.checkOut:u?.checkOut??D.checkOut}};var c=t(r(d[1]));function n(){const c=t(r(d[2]));return n=function(){return c},c}const l='YYYY-MM-DD'}),"18db38",["ba7a76","1772c9","e950a3"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createWishlistItemReplica=function(t){const o=null!=t.version?Number.parseInt(t.version,10):-1,s={wishlistId:void 0,productId:void 0,productType:void 0,wishlistItemId:void 0,deletedAt:void 0};return Object.keys(t).forEach((n=>{const c=n;s[c]={version:o,value:t[c]??null}})),s}}),"1b9467",[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SaveToListHeartsUIKey=void 0;var t=r(d[0]);const s={onSaveableEntityRead:null,autoSaveWishlist:null};e.SaveToListHeartsUIKey=(0,t.createUIKey)('save-to-list-hearts',{getDefault:()=>s})}),"39dfae",["005fd5"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MutationIdRegistryContext=void 0,e.useGenerateMutationId=function(){const{registerMutationId:o}=(0,t.useContext)(u);return(0,t.useCallback)((()=>{const t=`W-${(0,n().v4)()}`;return o(t),t}),[o])},e.useMutationIdRegistry=function(){const n=(0,t.useRef)([]);return(0,t.useMemo)((()=>({registerMutationId:t=>{n.current.push(t)},isMutationIdRegistered:t=>n.current.includes(t)})),[])};var t=r(d[0]);function n(){const t=r(d[1]);return n=function(){return t},t}const u=e.MutationIdRegistryContext=(0,t.createContext)({registerMutationId:()=>{},isMutationIdRegistered:()=>!1})}),"3a6972",["07aa1f","305dd5"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.getWishlistItemIds=o,e.isEntitySavedToAnyList=function(t,n,u){return o(t,n,u).length>0};var n=r(d[1]),u=t(r(d[2]));function o(t,o,s){return Array.from(t.wishlistItems).filter((t=>{const{productType:u,productId:l}=t;if(!l||!u||!(u in n.ProductTypeToEntityType))return!1;const c=n.ProductTypeToEntityType[u],y=l;return null==t.deletedAt&&c===o&&y===s})).map((t=>t.wishlistItemId)).filter(u.default)}}),"3e7627",["ba7a76","7ee7e4","58861b"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.WishlistEntityTypeToItemType=void 0,e.getDefaultNameFromPayload=function(t){const s=t?.presentation?.wishlistSaveToModal?.defaultWishlistName??null;return(0,l.hasError)(s)?null:s},e.legacyListsFromPayload=function(t){return t?.presentation?.wishlistIndexPage?.wishlists?.filter(o.default).map(c)};var l=r(d[1]),s=r(d[2]),n=r(d[3]),u=t(r(d[4])),o=t(r(d[5]));function c({collaboratorUsers:t,createdBy:l,dateRangeDetails:s,formattedDateRange:c,guestCount:_,guestDetails:E,id:I,inviteUrl:f,isCollaborative:p,isCollaborativeBasedOnShareToken:C,isPrivate:h,name:N,pictures:T,productIds:P,userId:A,wishlistUser:b,xlImageUrl:L}){return{airbnb_canonical_place_ids:(0,n.extractIds)(P?.airbnbCanonicalPlaceIds,n.ENTITY_REGEXES[u.default.AIRBNB_CANONICAL_PLACE]),checkin:s?.checkIn||void 0,checkout:s?.checkOut||void 0,collaboratorUsers:t,created_by:l,formattedDateRange:c,guests:_||1,guest_details:{localized_description:E?.description?.localizedString||'',number_of_adults:E?.numberOfAdults||1,number_of_children:E?.numberOfChildren||0,number_of_infants:E?.numberOfInfants||0},id:parseInt((0,n.extractId)(I),10),image_url:T?.[0]?.largePicture||void 0,invite_url:f||void 0,isCollaborative:p||C,listings_count:P?.stayIds.length||0,listing_ids_str:(0,n.extractIds)(P?.stayIds,n.ENTITY_REGEXES[u.default.LISTING]),mt_templates_count:P?.experienceIds.length||0,mt_template_ids:(0,n.extractIds)(P?.experienceIds,n.ENTITY_REGEXES[u.default.EXPERIENCE]),name:N||'',picture_urls:T?.map((t=>t?.largePicture)).filter(o.default),places_count:(P?.placeIds.length||0)+(P?.airbnbCanonicalPlaceIds.length||0),place_ids:(0,n.extractIds)(P?.placeIds,n.ENTITY_REGEXES[u.default.PLACE]),private:h&&!C,thumbnail_image_url:T?.[0]?.largePicture||void 0,user:b&&A?{first_name:b.firstName,has_profile_pic:!!b.thumbnailUrl,id:parseInt(A,10),idStr:A,picture_url:b.thumbnailUrl,smart_name:b.firstName,thumbnail_url:b.thumbnailUrl}:null,user_id:A||void 0,wishlistUser:b,xl_image_url:L||void 0}}e.WishlistEntityTypeToItemType={[u.default.LISTING]:'HOME',[u.default.EXPERIENCE]:'EXPERIENCE',[u.default.PLACE]:'PLACE',[u.default.AIRBNB_CANONICAL_PLACE]:'AIRBNB_CANONICAL_PLACE'},u.default.LISTING,s.VERTICAL_TYPES.homes,u.default.EXPERIENCE,s.VERTICAL_TYPES.experiences,u.default.PLACE,s.VERTICAL_TYPES.places,u.default.AIRBNB_CANONICAL_PLACE,s.VERTICAL_TYPES.places}),"3f2e27",["ba7a76","8ad8fb","8e0668","cfb703","d1b3af","58861b"]);
__d((function(g,r,i,a,m,e,d){"use strict";var s=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.dismissToastDispatch=function(s){return{...s,newToastVisible:!1}},e.errorToastDispatch=function(s,l){const{errorDisplayMessage:n=null,errorDisplayTitle:o=null}=l??{};return{...s,newToast:{actionText:null,title:o,message:n??t.default.t('shared.modal error'),imgSrc:null,wishlistName:null,onActionPress:null,isError:!0,key:null},newToastVisible:!0}},e.removedToastDispatch=function(s,l,n,o){return{...s,newToast:{actionText:null,message:t.default.t('wishlist.toast_message_removed_from_wishlist'),imgSrc:n??null,wishlistName:l,onActionPress:null,title:null,isError:!1,key:o},newToastVisible:!0}},e.savedToastDispatch=function(s,l,n,o,u){return{...s,newToast:{actionText:t.default.t('wish_list.button.change_wish_list'),message:t.default.t('wishlist.toast_message_saved_to_wishlist'),imgSrc:n.imgSrc??null,wishlistName:l??null,onActionPress:o,title:null,isError:!1,key:u},newToastVisible:!0}};var t=s(r(d[1]))}),"44059a",["ba7a76","a9f4b1"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.useAutoSaveWishlist=function(){const[{autoSaveWishlist:t}]=(0,y.useUIState)(p.SaveToListHeartsUIKey);return t},e.useHandleHeartClick=k,e.useInvalidateListsCache=E,Object.defineProperty(e,"usePrewarmWishlistItems",{enumerable:!0,get:function(){return L.usePrewarmWishlistItems}}),e.useWishlists=function(){const[{lists:t}]=(0,y.useUIState)(f.SaveToListModalUIKey),s=E();return{lists:t,invalidateListsCache:s}};var s=r(d[1]),n=r(d[2]),l=r(d[3]),o=r(d[4]),u=r(d[5]),c=t(r(d[6])),I=r(d[7]),h=r(d[8]),v=r(d[9]),y=r(d[10]),S=t(r(d[11])),U=r(d[12]),T=r(d[13]),p=r(d[14]),f=r(d[15]),W=r(d[16]),_=r(d[17]),w=r(d[18]),L=r(d[19]);function b(t,n){const[{onSaveableEntityRead:l}]=(0,y.useUIState)(p.SaveToListHeartsUIKey),o=n?(0,_.getEntityId)(n):null,u=(0,w.useIsEntitySavedToAnyList)(t,o);return(0,s.useEffect)((()=>{o&&l?.(t,o)}),[t,o,l]),u}function k(){const t=(0,w.useGetWishlistItemIds)(),{addWishlistItem:s,batchDeleteWishlistItems:o}=(0,w.useWishlistMutations)(),W=(0,h.useGenerateMutationId)(),L=(0,y.useUpdateUIState)(f.SaveToListModalUIKey),b=(0,y.useUpdateUIState)(p.SaveToListHeartsUIKey),k=(0,y.useUIStateGetter)(f.SaveToListModalUIKey),E=(0,y.useUIStateGetter)(p.SaveToListHeartsUIKey);return(0,v.useEvent)((async({entityType:h,entityId:v,imgSrc:y,productType:p,saveToListTarget:f,onSave:w,onUnsave:H,saveWithoutDates:K=!1,savingFrom:A,savingContext:C,sectionTypeUid:M,entityFilters:D})=>{if(!v)return;const{lists:F}=k(),{autoSaveWishlist:O}=E(),B=(0,_.getEntityId)(v),G=(f??O)?.id,J=S.default.isLoggedIn();L(U.dismissToastDispatch);const P=t(h,B),x=(0,c.default)(K,D),N={checkin:x.checkIn??void 0,checkout:x.checkOut??void 0,guests:(x?.adults||0)+(x?.children||0),target_id:B,target_type:(0,I.getTargetType)(h,p),section_type_uid:M,target_extra_data:{user_wishlist_ids:JSON.stringify(F?.map((({id:t})=>t))),is_logged_in:J.toString(),saving_from:A??'unknown',save_without_dates:K?.toString()||'false',saving_context:JSON.stringify(C)}},V={entityType:h,entityId:B,imgSrc:y,productType:p,eventData:N,entityFilters:D};if((0,I.logWishlistJitneyEvent)('saved.heart.listingHeart',{list_id:G?.toString(),...N}),J)if(P.length>0){const{data:t}=await(0,T.handleBatchDeleteWishlistItemsUIState)((async t=>o({variables:{wishlistItemIds:P,checkWishlistItemNotesBeforeUnsave:!t,checkWishlistItemVotesBeforeUnsave:!t}}).promise),L,y);(0,T.isBatchDeleteFailure)(t)||((0,I.logWishlistJitneyEvent)('saved.heart.listingHeart.unsave',{list_id:t?.batchDeleteWishlistItemsByWishlistItemId?.deletedWishlistItems?.[0]?.wishlistId??void 0,...N,checkin:void 0,checkout:void 0,guests:void 0}),H?.())}else if(null!=G){const{data:t}=await(0,T.handleAddWishlistItemUIState)((async()=>s({variables:{wishlistId:(0,n.createGlobalId)('Wishlist',G.toString()),savedItemType:l.WishlistEntityTypeToItemType[h],savedItemId:B,productType:p,mutationId:W(),treatmentFlags:(0,u.getAddWishlistItemTreatmentFlags)(),...x}})),L,b,V,C);(0,T.isAddItemFailure)(t)||w?.(t?.addWishlistItem?.wishlistItem?.wishlistItemId??null)}else L((t=>({...t,visible:!0,activeEntity:V})));else L((t=>({...t,requiresSignup:!0,visible:!0,activeEntity:V})))}))}function E(){const t=(0,y.useUpdateUIState)(p.SaveToListHeartsUIKey),n=(0,y.useUpdateUIState)(f.SaveToListModalUIKey),l=(0,y.useUpdateUIState)(W.WishlistItemsAsyncQueryUIKey),{clear:u}=(0,w.useWishlistMutations)();return(0,s.useCallback)((s=>{const{shouldAlertOtherTabs:c=!1}=s||{};n((t=>({...t,networkCacheVersion:t.networkCacheVersion+1}))),t((t=>({...t,autoSaveWishlist:null}))),l((t=>({...t,seenAsyncQueryItems:new Set}))),u(),c&&(0,o.broadcastSaveToListUpdate)()}),[u,l,t,n])}e.default=function(t,s){const n=b(t,s),l=k();return{isSaved:n,handleHeartClick:(0,v.useEvent)((n=>l({...n,entityType:t,entityId:s})))}}}),"4710c3",["ba7a76","07aa1f","56afe0","3f2e27","e3accc","821edf","18db38","6668de","3a6972","f4e9c4","afdc80","06a99e","44059a","e3a3dd","39dfae","f96184","648055","6a67c5","10c8a3","ef82e2"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WishlistItemsAsyncQueryUIKey=void 0;var t=r(d[0]);const s={seenAsyncQueryItems:new Set,tenantIntegrationInitialNetworkCacheVersion:new WeakMap};e.WishlistItemsAsyncQueryUIKey=(0,t.createUIKey)('save-to-list-wishlist-items-async-query',{getDefault:()=>s})}),"648055",["005fd5"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;function n(){const t=r(d[1]);return n=function(){return t},t}function o(){const t=r(d[2]);return o=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.getTargetType=function(t,n){if('listing'===t)return'STAY';if('experience'===t)return n??'EXPERIENCE';return'OTHER'},e.logWishlistJitneyEvent=function(t,s){u.default.logJitneyEvent({schema:o().UniversalComponentActionEvent,event_data:{logging_id:t,method:'onPress',uuid:(0,n().v4)(),operation:2,ancestor_logging_ids:[],ancestor_uuids:[],event_data:JSON.stringify(s),event_data_schema:"Saved.v3.WishlistDetailData"}})};var u=t(r(d[3]))}),"6668de",["ba7a76","305dd5","59c871","c8b97a"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getEntityId=function(n){try{return['ActivityListing','DemandStayListing'].includes((0,t.getTypenameSafe)(n)||'')?(0,t.getInternalId)(n):n}catch{return n}};var t=r(d[0])}),"6a67c5",["56afe0"]);
__d((function(g,r,i,a,m,e,d){"use strict";var E=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ProductTypeToV3PropertyName=e.ProductTypeToEntityType=e.EntityTypeToProductType=void 0;var t=E(r(d[1]));t.default.LISTING,t.default.EXPERIENCE,t.default.PLACE,t.default.AIRBNB_CANONICAL_PLACE,e.ProductTypeToEntityType={HOME:t.default.LISTING,EXPERIENCE:t.default.EXPERIENCE,PLACE:t.default.PLACE,AIRBNB_CANONICAL_PLACE:t.default.AIRBNB_CANONICAL_PLACE},e.EntityTypeToProductType={[t.default.LISTING]:'HOME',[t.default.EXPERIENCE]:'EXPERIENCE',[t.default.PLACE]:'PLACE',[t.default.AIRBNB_CANONICAL_PLACE]:'AIRBNB_CANONICAL_PLACE'},e.ProductTypeToV3PropertyName={HOME:'stayIds',EXPERIENCE:'experienceIds',PLACE:'placeIds',AIRBNB_CANONICAL_PLACE:'airbnbCanonicalPlaceIds'}}),"7ee7e4",["ba7a76","d1b3af"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.getAddWishlistItemTreatmentFlags=function(){switch(u.Flagger.findTreatment((0,n.default)('wishlist_tenant_integration_web'))){case'control':return['upfrontQuery'];case'async_only':return['asyncQuery'];case'treatment':return['tenantIntegration'];default:return null}};var n=t(r(d[1])),u=r(d[2])}),"821edf",["ba7a76","4d3544","dcc72a"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VERTICAL_TYPES=e.LAST_UPDATE_SESSION_STORAGE_KEY=void 0;e.LAST_UPDATE_SESSION_STORAGE_KEY='SAVE_TO_LIST_LAST_UPDATE',e.VERTICAL_TYPES={homes:'Homes',experiences:'Experiences',places:'Places',services:'Services'}}),"8e0668",[]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.MutationQueue=void 0;var s=t(r(d[1])),l=t(r(d[2])),u=r(d[3]),n=t(r(d[4])),o=r(d[5]),h=r(d[6]);function c({mutate:t}){let s,l;return{promise:new Promise(((t,u)=>{s=t,l=u})),mutate:async(...u)=>{try{const l=await t(...u);return s(l),l}catch(t){throw l(t),t}}}}var f=(0,l.default)("queue"),p=(0,l.default)("onMutationAdded"),I=(0,l.default)("onMutationSettled"),w=(0,l.default)("nextOptimisticID"),v=(0,l.default)("resolvedOptimisticIDs"),b=(0,l.default)("rejectedOptimisticIDs"),y=(0,l.default)("addMutation"),O=(0,l.default)("generateOptimisticID"),M=(0,l.default)("resolveOptimisticId");function P({mutation:t,optimisticUpdate:l}){const u=(0,s.default)(this,f)[f].map((({promise:t})=>t)),n=Promise.allSettled(u),o=(async()=>{let l;u.length&&await n;try{l=await t()}finally{(0,s.default)(this,f)[f].shift(),(0,s.default)(this,I)[I]?.(l)}})(),h={promise:o,optimisticUpdate:l};return(0,s.default)(this,f)[f].push(h),(0,s.default)(this,p)[p]?.(),o}function S(){return"optimistic-id:"+(0,s.default)(this,w)[w]++}function W(t){if(!t.startsWith('optimistic-id:'))return t;const l=(0,s.default)(this,v)[v].get(t);return l||null}e.MutationQueue=class{constructor(t={}){Object.defineProperty(this,M,{value:W}),Object.defineProperty(this,O,{value:S}),Object.defineProperty(this,y,{value:P}),Object.defineProperty(this,f,{writable:!0,value:[]}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:0}),Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,b,{writable:!0,value:void 0}),t.onMutationAdded&&((0,s.default)(this,p)[p]=t.onMutationAdded),t.onMutationSettled&&((0,s.default)(this,I)[I]=t.onMutationSettled),(0,s.default)(this,v)[v]=new Map,(0,s.default)(this,b)[b]=new Set}hasPendingMutations(){return(0,s.default)(this,f)[f].length>0}applyOptimisticUpdates(t){return(0,s.default)(this,f)[f].reduce(((t,{optimisticUpdate:s})=>s(t)),(0,o.removeVersioningMetadata)(t))}createWishlist({mutate:t,options:l}){const{mutate:u,promise:n}=c({mutate:t}),o=(0,s.default)(this,O)[O]();return(0,s.default)(this,y)[y]({mutation:async()=>{const{name:t}=l?.variables??{},{data:n,error:h}=await u(l),c=n?.createWishlist?.wishlistId;if(!h&&t&&c){const l={id:{version:-1,value:c},name:{version:-1,value:t},deletedAt:{version:-1,value:null}};return(0,s.default)(this,v)[v].set(o,c),{wishlists:[l]}}return(0,s.default)(this,b)[b].add(o),{}},optimisticUpdate:t=>{const{name:s}=l?.variables??{},u={id:o,name:s,deletedAt:null};return{...t,wishlists:[u,...t.wishlists]}}}),{promise:n,optimisticWishlistId:o}}addWishlistItem({mutate:t,options:l}){const{mutate:n,promise:o}=c({mutate:t}),f=(0,s.default)(this,O)[O]();return(0,s.default)(this,y)[y]({mutation:async()=>{const{savedItemId:t,savedItemType:o,wishlistId:c}=l?.variables??{},p=(0,s.default)(this,M)[M]((0,u.extractId)(c));if(p){const{data:c,error:I}=await n(l&&{...l,variables:l.variables&&{...l.variables,wishlistId:(0,u.encodeId)(p)}}),w=c?.addWishlistItem?.wishlistItem;if(!I&&t&&o&&p&&w&&w.wishlistItemId)return(0,s.default)(this,v)[v].set(f,w.wishlistItemId),{wishlists:[],wishlistItems:new Set([(0,h.createWishlistItemReplica)(w)])}}return(0,s.default)(this,b)[b].add(f),{}},optimisticUpdate:t=>{const{savedItemId:n,savedItemType:o,wishlistId:h}=l?.variables??{},c=(0,u.extractId)(h);if((0,s.default)(this,b)[b].has(c))return t;const p={wishlistId:(0,s.default)(this,M)[M](c)??c,productId:n,productType:o,wishlistItemId:f,deletedAt:null};return{...t,wishlistItems:new Set([...t.wishlistItems,p])}}}),{promise:o,optimisticWishlistItemId:f}}batchDeleteWishlistItems({mutate:t,options:l}){const{mutate:u,promise:o}=c({mutate:t}),f=(new Date).toISOString();return(0,s.default)(this,y)[y]({mutation:async()=>{const{wishlistItemIds:t}=l?.variables??{},o=(t??[]).filter(n.default).map((t=>(0,s.default)(this,M)[M](t)));if(o.every(n.default)){const{data:t,error:s}=await u(l&&{...l,variables:l.variables&&{...l.variables,wishlistItemIds:o}}),c=t?.batchDeleteWishlistItemsByWishlistItemId?.deletedWishlistItems;if(!s&&c)return{wishlists:[],wishlistItems:new Set(c.filter(n.default).map((t=>(0,h.createWishlistItemReplica)({version:t?.version,wishlistItemId:t?.wishlistItemId,deletedAt:t?.deletedAt??(new Date).toISOString()}))))}}return{}},optimisticUpdate:t=>{const{wishlistItemIds:u}=l?.variables??{},o=(u??[]).filter(n.default).filter((t=>!(0,s.default)(this,b)[b].has(t))).map((t=>(0,s.default)(this,M)[M](t)??t)),h=[...t.wishlistItems].map((t=>({...t,deletedAt:t.wishlistItemId&&o.includes(t.wishlistItemId)?f:t.deletedAt})));return{...t,wishlistItems:new Set(h)}}}),{promise:o}}}}),"957ea8",["ba7a76","76718e","99527b","cfb703","58861b","e06512","1b9467"]);
__d((function(g,r,i,a,m,e,d){
/**
   * @license React
   * use-sync-external-store-with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */
"use strict";var u=r(d[0]);var n="function"==typeof Object.is?Object.is:function(u,n){return u===n&&(0!==u||1/u==1/n)||u!=u&&n!=n},t=u.useSyncExternalStore,l=u.useRef,c=u.useEffect,f=u.useMemo,o=u.useDebugValue;e.useSyncExternalStoreWithSelector=function(u,v,s,S,h){var V=l(null);if(null===V.current){var b={hasValue:!1,value:null};V.current=b}else b=V.current;V=f((function(){function u(u){if(!c){if(c=!0,t=u,u=S(u),void 0!==h&&b.hasValue){var f=b.value;if(h(f,u))return l=f}return l=u}if(f=l,n(t,u))return f;var o=S(u);return void 0!==h&&h(f,o)?(t=u,f):(t=u,l=o)}var t,l,c=!1,f=void 0===s?null:s;return[function(){return u(v())},null===f?void 0:function(){return u(f())}]}),[v,s,S,h]);var y=t(u,V[0],V[1]);return c((function(){b.hasValue=!0,b.value=y}),[y]),o(y),y}}),"995183",["07aa1f"]);
__d((function(g,r,i,a,m,e,d){'use strict';m.exports=r(d[0])}),"addeb5",["995183"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=t(r(d[1]));const n={document:void 0,getDocument:()=>r(d[3])(d[2]).then(u.default).then((t=>t.default)),name:'AddWishlistItemMutation',type:'mutation',operationId:'9896b1e0f9ba09b67a8f96b1667f95335b34b97499d29e141cdaa4ba73c33acd'};e.default=n}),"bd6cf7",["ba7a76","45f788","a1e175","057569"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ENTITY_REGEXES=void 0,e.encodeId=function(t,c){switch(c){case n.default.LISTING:return btoa(`StayListing:${t}`);case n.default.EXPERIENCE:return btoa(`ExperienceListing:${t}`);case n.default.PLACE:return btoa(`PlaceListing:${t}`);case n.default.AIRBNB_CANONICAL_PLACE:return btoa(`WishlistCanonicalPlaceListing:${t}`);default:return btoa(`Wishlist:${t}`)}},e.extractId=u,e.extractIds=function(t,n){return t?.map((t=>u(t,n)))??[]};var n=t(r(d[1]));const c=/Wishlist:(.*)/;e.ENTITY_REGEXES={[n.default.LISTING]:/StayListing:(.*)/,[n.default.EXPERIENCE]:/ExperienceListing:(.*)/,[n.default.PLACE]:/PlaceListing:(.*)/,[n.default.AIRBNB_CANONICAL_PLACE]:/WishlistCanonicalPlaceListing:(.*)/};function s(t){return'function'==typeof atob?atob(t||''):Buffer.from(t||'','base64').toString()}function u(t,n){const u=s(t),o=(n||c).exec(u);return decodeURIComponent(o?o[1]:'')}}),"cfb703",["ba7a76","d1b3af"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.identitySelector=e.Store=void 0,e.useStore=function(t,s){return(0,n.useSyncExternalStoreWithSelector)(t.subscribe,t.getState,t.getInitialState,s)};var s=t(r(d[1])),u=t(r(d[2])),l=t(r(d[3])),n=r(d[4]),S=(0,u.default)("initialState"),b=(0,u.default)("state");e.Store=class{constructor(t){Object.defineProperty(this,S,{writable:!0,value:void 0}),Object.defineProperty(this,b,{writable:!0,value:void 0}),(0,s.default)(this,S)[S]=t,(0,s.default)(this,b)[b]=(0,l.default)(t),this.subscribe=this.subscribe.bind(this),this.getState=this.getState.bind(this),this.getInitialState=this.getInitialState.bind(this)}getState(){return(0,s.default)(this,b)[b].getState()}getInitialState(){return(0,s.default)(this,S)[S]}setState(t){return(0,s.default)(this,b)[b].setState(t)}subscribe(t){return(0,s.default)(this,b)[b].subscribe(t)}};e.identitySelector=t=>t}),"d0f410",["ba7a76","76718e","99527b","319658","addeb5"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=t(r(d[1]));const n={document:void 0,getDocument:()=>r(d[3])(d[2]).then(u.default).then((t=>t.default)),name:'CreateWishlistMutation',type:'mutation',operationId:'c3e7e1b9e9f501efcac10d111706a86093d48bb8377a772b26fc0114ba5dc934'};e.default=n}),"d7b2e2",["ba7a76","45f788","d642ab","057569"]);
__d((function(g,r,i,a,m,e,d){"use strict";function s(s,t){return null==s?t:null==t||s.version>t.version?s:t}Object.defineProperty(e,"__esModule",{value:!0}),e.merge=function(t,l){const n={wishlists:t.wishlists.map((s=>({...s}))),wishlistItems:new Set([...t.wishlistItems].map((s=>({...s}))))};l.wishlists&&l.wishlists.forEach((t=>{const l=n.wishlists.find((s=>null!=s.id?.value&&s.id?.value===t.id?.value));l?Object.keys(t).forEach((n=>{l[n]=s(l[n],t[n])})):n.wishlists.unshift(t)}));l.wishlistItems&&l.wishlistItems.forEach((t=>{const l=[...n.wishlistItems].find((s=>null!=s.wishlistItemId?.value&&s.wishlistItemId?.value===t.wishlistItemId?.value));l?Object.keys(t).forEach((n=>{l[n]=s(l[n],t[n])})):n.wishlistItems.add(t)}));return n},e.removeVersioningMetadata=function(s){return{wishlists:s.wishlists.map((s=>Object.fromEntries(Object.entries(s).map((([s,t])=>[s,t?.value]))))),wishlistItems:new Set([...s.wishlistItems].map((s=>Object.fromEntries(Object.entries(s).map((([s,t])=>[s,t?.value]))))))}}}),"e06512",[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.handleAddWishlistItemUIState=function(n,o,u,c,h){let I;return s({mutate:async()=>{const{promise:s,optimisticWishlistItemId:l}=await n();return I=()=>{o((s=>(0,t.dismissToastDispatch)({...s,visible:!0,wishlistItemIdToRemove:l})))},s},isFailure:l,onSuccess({addWishlistItem:s}){const{statusCode:l,wishlistItem:n}=s??{},{wishlistName:v,wishlistId:W,wishlistItemId:w,version:y}=n??{};'OK'===l&&null!=v&&null!=W&&(o((s=>({...(0,t.savedToastDispatch)(s,v,c,I,`${w}-${y}`),activeEntity:c}))),u((t=>t.autoSaveWishlist?.id!==W?{...t,autoSaveWishlist:{id:W,savingContext:h}}:t)))},onFailure(s){o((l=>{const n=s?.addWishlistItem?.errorContent??null;return{...(0,t.errorToastDispatch)(l,n),autoSaveWishlist:null}})),u((t=>t.autoSaveWishlist?{...t,autoSaveWishlist:null}:t))}})},e.handleBatchDeleteWishlistItemsUIState=async function(l,o,u){const c=s=>{const{statusCode:l,deletedWishlistItems:n=[]}=s?.batchDeleteWishlistItemsByWishlistItemId??{},{wishlistName:c,wishlistItemId:h,version:I}=n?.[0]??{};'OK'===l&&null!=c&&o((s=>(0,t.removedToastDispatch)(s,c,u,`${h}-${I}`)))};let h;const I=new Promise((t=>{h=t}));let v;v=await s({mutate:()=>l(!1),isFailure:n,onSuccess:c,onFailure(u){const{statusCode:I,wishlistItemVotesBlockedUnsave:W,wishlistItemNotesBlockedUnsave:w,userMessageTitle:y=null,userMessageSubtitle:S=null}=u?.batchDeleteWishlistItemsByWishlistItemId??{};o('OK'!==I&&(w||W)?u=>({...u,unsaveNoteConfirmation:{isOpen:!0,title:y,subtitle:S,async onCancel(){h()},async onRemove(){v=await s({mutate:()=>l(!0),isFailure:n,onSuccess:c,onFailure:()=>{o(t.errorToastDispatch)}}),h()}}}):t.errorToastDispatch)}}),n(v.data)&&await I;return v},e.isAddItemFailure=l,e.isBatchDeleteFailure=n;var t=r(d[0]);async function s({mutate:t,isFailure:s,onSuccess:l,onFailure:n}){let o,u;try{const s=await t();return o=s.data,u=s.error,o&&!u&&l(o),s}finally{(!o||u||s(o))&&n(o)}}function l(t){return'OK'!==t?.addWishlistItem?.statusCode}function n(t){return'OK'!==t?.batchDeleteWishlistItemsByWishlistItemId?.statusCode}}),"e3a3dd",["44059a"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;function _(){const t=r(d[1]);return _=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.SAVE_TO_LIST_LOCALSTORAGE_UPDATE_KEY=void 0,e.broadcastSaveToListUpdate=function(){const t=(0,_().v4)();if((0,o.default)()){try{window.sessionStorage?.setItem(n.LAST_UPDATE_SESSION_STORAGE_KEY,t)}catch{}try{window.localStorage.setItem(c,t)}catch(t){}}};var o=t(r(d[2])),n=r(d[3]);const c=e.SAVE_TO_LIST_LOCALSTORAGE_UPDATE_KEY='save_to_list_update'}),"e3accc",["ba7a76","305dd5","c916d0","8e0668"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.usePrewarmWishlistItems=function({items:t,cacheKey:u}){const{networkCacheVersion:y}=(0,f.useReadUIState)(T.SaveToListModalUIKey),[{seenAsyncQueryItems:o,tenantIntegrationInitialNetworkCacheVersion:p},h]=(0,f.useUIState)(w.WishlistItemsAsyncQueryUIKey),v='treatment'===l.Flagger.findTreatment((0,n.default)('wishlist_tenant_integration_web')),A=(0,s.useMemo)((()=>{if(!t||!u)return null;const s=p.get(u);return null!=s?s:(p.set(u,y),y)}),[t,u,y,p]),Q=Boolean(A&&y>A),E=(0,s.useMemo)((()=>v&&t&&!Q?t.flatMap((({entityType:t,entityId:s,wishlistItems:n})=>null!=s&&n?n.filter(c.default).map((n=>({...n,productType:I.EntityTypeToProductType[t],productId:(0,S.getEntityId)(s)}))):[])):null),[Q,t,v]);(0,U.useMergeWishlistItems)(E),(0,s.useEffect)((()=>{if(!v||null==t)return;const s=new Set(t.flatMap((({entityType:t,entityId:s,wishlistItems:n})=>null==s||null==n?[]:[M(t,(0,S.getEntityId)(s))])).filter((t=>!o.has(t))));s.size&&h((t=>({...t,seenAsyncQueryItems:new Set([...t.seenAsyncQueryItems,...s])})))}),[t,A,y,o,v,h])},e.useWishlistItemsAsyncQuery=function({skip:t}){const n=(0,f.useUpdateUIState)(h.SaveToListHeartsUIKey),l=(0,f.useUpdateUIState)(w.WishlistItemsAsyncQueryUIKey),S=(0,f.useUIStateGetter)(w.WishlistItemsAsyncQueryUIKey),{networkCacheVersion:v}=(0,f.useReadUIState)(T.SaveToListModalUIKey),A=(0,s.useRef)([]),[Q,E]=(0,s.useState)(null),[{listingIds:_,listingType:W},k]=(0,s.useState)({listingIds:[],listingType:'HOME'}),{data:K,loading:C}=(0,u().useClientSideQuery)(y.default,{variables:{listingIds:_,listingType:W,networkCacheVersion:v},skip:t||!p.default.isLoggedIn()||0===_.length}),b=(0,s.useMemo)((()=>C?void 0:K?.presentation?.wishlistItemsInfo?.filter(c.default).flatMap((({listingId:t,wishlistItems:s})=>s?.filter(c.default).map((s=>({__typename:'WishlistItem',deletedAt:null,productId:t,productType:W,version:null,wishlistId:s.wishlistId,wishlistItemId:s.wishlistItemId,wishlistName:null})))))),[K?.presentation?.wishlistItemsInfo,W,C]),L=(0,o.default)((()=>{if(null==Q&&A.current.length>0){const{entityType:t}=A.current[0];E(A.current.filter((s=>s.entityType===t))),A.current=A.current.filter((s=>s.entityType!==t))}}),100),P=(0,s.useCallback)(((t,s)=>{if(!s)return;const{seenAsyncQueryItems:n}=S(),u=M(t,s);n.has(u)||(A.current.push({entityType:t,entityId:s}),l((t=>({...t,seenAsyncQueryItems:new Set([...t.seenAsyncQueryItems,u])}))),L())}),[S,L,l]);(0,s.useEffect)((()=>{n((s=>({...s,onSaveableEntityRead:t?null:P})))}),[P,t,n]),(0,U.useMergeWishlistItems)(b),(0,s.useEffect)((()=>{if(Q&&!C){const{entityType:t}=Q[0],s=I.EntityTypeToProductType[t];k({listingIds:Q.map((({entityId:t})=>t)),listingType:s}),E(null),L()}}),[Q,C,L])};var s=r(d[1]),n=t(r(d[2])),l=r(d[3]);function u(){const t=r(d[4]);return u=function(){return t},t}var y=t(r(d[5])),I=r(d[6]),o=t(r(d[7])),c=t(r(d[8])),f=r(d[9]),p=t(r(d[10])),h=r(d[11]),T=r(d[12]),w=r(d[13]),S=r(d[14]),U=r(d[15]);function M(t,s){return`${t}:${s}`}}),"ef82e2",["ba7a76","07aa1f","4d3544","dcc72a","068abc","ff5597","7ee7e4","5a0957","58861b","afdc80","06a99e","39dfae","f96184","648055","6a67c5","10c8a3"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SaveToListModalUIKey=e.DEFAULT_NETWORK_CACHE_VERSION=void 0;var t=r(d[0]);const l={visible:!1,activeEntity:null,newToast:null,newToastVisible:!1,unsaveNoteConfirmation:null,lists:null,requiresSignup:!1,wishlistItemIdToRemove:null,networkCacheVersion:e.DEFAULT_NETWORK_CACHE_VERSION=1};e.SaveToListModalUIKey=(0,t.createUIKey)('save-to-list-modal',{getDefault:()=>l})}),"f96184",["005fd5"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=t(r(d[1]));const n={document:void 0,getDocument:()=>r(d[3])(d[2]).then(u.default).then((t=>t.default)),name:'BatchDeleteWishlistItemsByWishlistItemIdMutation',type:'mutation',operationId:'30458ff942dbd7bcb643171c0c2c2a816108897e8e8f565fe8ae2d62ad1257e2'};e.default=n}),"f9f96a",["ba7a76","45f788","8a7f14","057569"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=t(r(d[1]));const c={document:void 0,getDocument:()=>r(d[3])(d[2]).then(u.default).then((t=>t.default)),name:'WishlistItemsAsyncQuery',type:'query',operationId:'084d540359ef9152886c8fb7065f7905787a36849aeaf0c1cb629a518894c60c'};e.default=c}),"ff5597",["ba7a76","45f788","505351","057569"]);
__r("a9f4b1").extend({"shared.modal error":"An error occurred. Please try again later.","wishlist.toast_message_removed_from_wishlist":"Removed from %{bold_start}%{wishlist_name}%{bold_end}","wish_list.button.change_wish_list":"Change","wishlist.toast_message_saved_to_wishlist":"Saved to %{bold_start}%{wishlist_name}%{bold_end}"});
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/29a7.bbd0615484.js.map