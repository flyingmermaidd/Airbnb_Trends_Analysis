__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,n){if(!('categoriesToTools'in t))return{};const o=new Set(n?.consentTerms?.accepted),c={Strict:[],Performance:[],Functional:[],Targeting:[]},{categoriesToTools:s}=t;return Object.keys(s).forEach((t=>{c[t]=s[t].map((({toolKey:n,friendlyName:c,key:s})=>({key:s,toolKey:n,friendlyName:c,active:'Strict'===t||o.has(s)})))})),c},e.hasSections=function(t){return Object.keys(t).length>0}}),"181a79",[]);
__d((function(g,r,i,a,m,e,d){"use strict";var n=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.populateDataLayer=function(n,u){const c=s(n,u);if(0===c.length)return;(0,o.default)({source:'cookies_banner',consentTags:(0,o.getTagsFromData)(Object.fromEntries(c.map((n=>[n,!0]))))});const l=c.join(',');window.dataLayer?.push({event:t.OneTrustDataLayerKey,[t.OneTrustConsentKey]:l},{event:t.OptanonDataLayerKey,[t.OptanonConsentKey]:l})};var t=r(d[1]),o=n(r(d[2]));function s(n,t){const{accepted:o}=n||{};return(o||[]).map((n=>n&&n in t?t[n]:null)).filter(Boolean)}}),"20ba55",["45f788","ea44e9","e25f83"]);
__d((function(g,r,i,a,m,e,d){"use strict";var n=r(d[0]).default,o=r(d[1]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({forceShow:n,footerHeight:o,setIsCookieBannerInitiallyNeeded:N,onSubmitConsent:h}){const[V,_]=(0,t.useState)(null),{markAsComplete:b}=(0,s.usePresenter)(u.default),E=(0,t.useCallback)((()=>{h&&h(),b()}),[h,b]);return(0,v.jsx)(I.default,{termName:l.TermNames.COOKIES_BANNER,query:f.default,mutation:c.default,variables:{forQuery:{includeConfigView:!0}},resolveConsentId:{forQuery:C.resolveQueryConsentId,forMutation:C.resolveMutationConsentId},resolveConsentValue:{forQuery:C.resolveQueryConsentValue,forMutation:(n,o)=>(0,C.resolveMutationConsentValue)(V,o)},persist:!0,children:({submitConsent:t,consentValue:s,loading:u,error:l})=>u||l||!s?null:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(S,{loading:u,error:l,consentValue:s,forceShow:!!n,setIsCookieBannerInitiallyNeeded:N}),(0,v.jsx)(y.default,{forceShow:!!n,footerHeight:o,submitConsent:t,onSubmitConsent:E,consentValue:s,setToolsData:_})]})})};var t=r(d[2]),s=r(d[3]),u=o(r(d[4])),l=r(d[5]),f=n(r(d[6])),c=n(r(d[7])),C=r(d[8]),N=r(d[9]),I=n(r(d[10])),y=n(r(d[11])),v=r(d[12]);function S({loading:n,error:o,consentValue:l,forceShow:f,setIsCookieBannerInitiallyNeeded:c}){const C=(0,s.useFutureAnnouncement)(u.USER_CONSENT_ANNOUNCEMENT_ID);(0,t.useEffect)((()=>{if(n||o)return;const{showConsent:t}=(0,N.getConsentInformationFromData)(l);f||!!t?C?.ready():C?.cancel(),c&&c(!!t)}),[f,n,o,l,c,C])}}),"27ba7f",["ba7a76","45f788","07aa1f","502fde","ed263e","ea44e9","cee7e5","d76afa","ac953c","38f1d7","4cba4b","f89373","b8c07d"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({children:t,query:u,mutation:l,variables:f,termName:v,persist:c,resolveConsentId:b,resolveConsentValue:C}){const{consentValue:p,loading:y,error:V}=(0,o.default)({query:u,variables:f?.forQuery,distributeOpts:{termName:v,persist:c,resolveConsentId:b?.forQuery,resolveConsentValue:C?.forQuery}}),M=(0,n.default)({mutation:l,variables:f?.forMutation,distributeOpts:{termName:v,persist:c,resolveConsentId:b?.forMutation,resolveConsentValue:C?.forMutation}});return(0,s.jsx)(s.Fragment,{children:t({submitConsent:M,consentValue:p,loading:y,error:V})})};var n=t(r(d[1])),o=t(r(d[2])),s=r(d[3])}),"4cba4b",["ba7a76","e4b3ca","5f0ce4","b8c07d"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({sectionsConfig:c,submitConsent:s,defaultTargetingDecline:o}){const{Strict:l,Targeting:p,...f}=c,y=(0,t.useRef)({accepted:l,rejected:o?p:[]}),_=(0,t.useRef)(n(o?f:{...f,Targeting:p})),k=t=>()=>{const{mutationValues:c}=u(_.current,y.current,t);s({...c})},j=k((()=>!0)),v=k((()=>!1));return[j,v,t=>{k((({toolKey:c,active:n})=>t[c]??n))()}]};var t=r(d[0]),c=r(d[1]);const n=t=>Object.keys(t).reduce(((c,n)=>{const u=t[n];return u&&c.push(...u),c}),[]),u=(t,n,u)=>{const s=n.accepted.map((({key:t})=>t)),o=n.rejected.map((({key:t})=>t));return{localValues:t.map((t=>{const n=u(t);return"client-side-key"===t.key?(0,c.airdogCount)('user_consent.unexpected.state',1,'data:local_id_v2'):(n?s:o).push(t.key),{...t,active:n}})),mutationValues:{accepted:s,rejected:o}}}}),"5bc414",["07aa1f","3e4681"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default,n=r(d[1]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({children:t,prefetchModal:n,sectionsConfig:C,submitConsent:P,defaultTargetingDecline:_}){const[A,N]=(0,s.useState)(!0),[O,S]=(0,s.useState)(!1),[b,p]=(0,s.useState)(!1),T=(0,u.default)(),j='treatment_1'===T,[v,y,D]=(0,l.default)({sectionsConfig:C,submitConsent:P,defaultTargetingDecline:_}),I=(0,s.useCallback)((()=>{j?(p(!0),setTimeout((()=>{N(!1)}),c.COOKIE_BANNER_ANIMATION_DURATION)):N(!1)}),[j]),R=A||n||O;return(0,h.jsxs)(h.Fragment,{children:['function'==typeof t&&t({onPressPreferences:()=>{S(!0),N(!1)},onPressAccept:()=>{v(),I()},onPressReject:()=>{y(),I()},showBanner:A,showSlideDownAnimation:b,brightPatternErfAssignment:T,shouldUseBrightPattern:j}),(0,h.jsx)(o.default,{loadReady:R,loader:f.cookiesPreferencesContextSheetLoader,renderPlaceholder:o.renderNull,isOpen:O,onClose:()=>{S(!1),N(!0)},onSave:t=>{D(t),S(!1),N(!1)},sectionsConfig:C,usesLegacy:!1})]})};var s=r(d[2]),o=n(r(d[3])),l=t(r(d[4])),u=t(r(d[5])),c=r(d[6]),f=r(d[7]),h=r(d[8])}),"b412d1",["ba7a76","45f788","07aa1f","018c3b","5bc414","52a189","b8f0bb","4031e0","b8c07d"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=t(r(d[1]));const f={document:void 0,getDocument:()=>r(d[3])(d[2]).then(u.default).then((t=>t.default)),name:'GetConsentForUserQuery',type:'query',operationId:'089aadf2c36cc3644e56eefea64291974d924f2174a47385fa09f2da343cbe9b'};e.default=f}),"cee7e5",["ba7a76","45f788","f1432e","057569"]);
__d((function(g,r,i,a,m,e,d){"use strict";var o=r(d[0]).default,t=r(d[1]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({footerHeight:o,forceShow:t,submitConsent:y,onSubmitConsent:A,consentValue:p,setToolsData:D}){const E=(0,P.default)(),{showConsent:K,showRejectAll:b,configView:R,consentRecord:v}=(0,w.getConsentInformationFromData)(p),x=(0,n.useMemo)((()=>(0,h.default)(R,v)),[]),H=(0,c.default)(),N=new Set('categoriesToCookies'in R?R.categoriesToCookies.Strict:[]);(0,n.useEffect)((()=>{'toolKeyToToolId'in R&&D(R.toolKeyToToolId)}),[]),(0,T.default)((()=>{'toolKeyToToolId'in R&&((0,C.populateDataLayer)(v?.consentTerms,R.toolKeyToToolId),l.default.emit(u.CHECK_CONSENT_EVENT))}),'toolKeyToToolId'in R);if((0,f.default)(!!K,N,H),!(0,h.hasSections)(x))return(0,s.airdogCount)('user_consent.unexpected.state',1,'missing:sections_config'),null;return K||t?(0,j.jsx)(S.default,{submitConsent:o=>{y({...o,termsConfigurationId:'configurationId'in R?R.configurationId:''}),A&&A()},sectionsConfig:x,defaultTargetingDecline:E,children:({showBanner:t,showSlideDownAnimation:n,brightPatternErfAssignment:s,shouldUseBrightPattern:l,onPressPreferences:u,onPressAccept:c,onPressReject:f})=>{const T=l?I.default:_.default,h=l||b;return t?(0,j.jsx)(T,{allowReject:h,onPressReject:f,onPressPreferences:u,onPressAccept:c,footerHeight:o,showSlideDownAnimation:n,erfAssignment:s}):null}}):null};var n=r(d[2]),s=r(d[3]),l=t(r(d[4])),u=r(d[5]),c=t(r(d[6])),f=t(r(d[7])),T=t(r(d[8])),h=o(r(d[9])),C=r(d[10]),w=r(d[11]),P=t(r(d[12])),I=t(r(d[13])),S=t(r(d[14])),_=t(r(d[15])),j=r(d[16])}),"f89373",["45f788","ba7a76","07aa1f","3e4681","abc3e4","ea44e9","09d4ab","a7b5f6","29f7c3","181a79","20ba55","38f1d7","16cc83","b8f0bb","b412d1","c4efde","b8c07d"]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/frontend/user-consent/components/CookiesBannerContainerLegacy.e3e6ff558d.js.map