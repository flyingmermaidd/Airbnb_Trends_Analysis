__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;function n(){const t=r(d[1]);return n=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.initRemarketingDataV2=function(t,h=!1){if(c.default.isTrebuchetLaunched((0,u.default)('gtm.get_data_layer_variables.remarketing.cache')))return(0,l.getDataLayerVariables)(t).then((t=>({...t,event_id:(0,n().v4)()}))).catch((()=>_));const p="/v2/get-data-layer-variables",y=`${p}/${(0,o.getBev)()}`,b=v.default.current().idStr||(0,o.getBev)(),I=`${p}/${b}`;if(h){const t=(0,f.localStorageGetItem)(I,{fromAmplify:!0});if(t)return v.default.isLoggedIn()&&(0,f.localStorageSetItem)(y,t,{expires:S}),Promise.resolve(t)}return new Promise((o=>{s().default.post(`/api${p}`,{body:JSON.stringify(t||{})}).then((t=>{const c={...t,event_id:(0,n().v4)()};return h&&((0,f.localStorageSetItem)(I,c,{expires:S}),v.default.isLoggedIn()&&(0,f.localStorageSetItem)(y,c,{expires:S})),o(c)})).catch((()=>{o(_)}))}))};var o=r(d[2]),c=t(r(d[3])),u=t(r(d[4])),l=r(d[5]);function s(){const n=t(r(d[6]));return s=function(){return n},n}var f=r(d[7]),v=t(r(d[8]));const S=864e5,_={}}),"1949a1",["ba7a76","305dd5","b4aab0","dcc72a","2c6bf9","858066","69a7c4","13babd","06a99e"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default,n=r(d[1]).default;function s(){const t=r(d[2]);return s=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.updateP2Remarketing=function({filters:t,listingIds:n=[],geography:s,remarketingIds:u,canonicalLocation:o}){const c=new RegExp("=(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))(&|$)"),_=decodeURIComponent(window.location.href),l=c.test(_);l&&p.default.logEvent({event_name:'urls_with_pii',event_data:{url:_,datadog_key:'paid_growth.urls_with_pii',datadog_tags:'source:p2'}});return b({canonicalLocation:o,checkin:t.checkin||'',checkout:t.checkout||'',topListingIds:Array.isArray(u)&&u.length>0?u.slice(0,10):n.slice(0,10),city:s?.city??'N/A',state:s?.state??'N/A',country:s?.country??'N/A',num_adults:t.adults||1,num_children:t.children||0,num_infants:t.infants||0,filters:t,remarketingIds:u,resultIds:n,urlContainsPII:l})};var u=n(r(d[3])),o=r(d[4]),c=r(d[5]),_=t(r(d[6])),l=r(d[7]),y=n(r(d[8])),p=n(r(d[9])),h=n(r(d[10])),f=n(r(d[11]));const k='searchresults',v='optout';function I({canonicalLocation:t,checkin:n,checkout:l,topListingIds:v,city:I,state:b,country:P,num_adults:L,num_children:w,num_infants:x,filters:D,remarketingIds:E,resultIds:A,urlContainsPII:T},N){const C=y.default.makeGoogleDynxParams(k,v,n,l);if(C.dynx_pagetype='p2',C.dynx_itemid=(0,c.locationToURLParameter)(t).toLowerCase(),(0,_.pushEventsToDataLayer)([{event:'dynx',data:{dynx_params:C,urlContainsPII:T}},{event:'searchListings',data:{user_country:u.default.country(),top_listing_ids:v,city:I,state:b,country:P,num_adults:L,num_children:w,num_infants:x,...N}}]),D.work_trip&&(0,_.default)({event:'workTripSearchListings',data:{user_country:u.default.country()}}),n&&l&&(0,_.default)({event:'searchListingsWithDates',data:{user_country:u.default.country()}}),h.default.getBootstrap('remarketing_jitney_logging'))try{const t=JSON.stringify({...N,city:I,region:b,country:P,user_country:u.default.country(),dynxParams:C});p.default.logJitneyEvent({schema:s().PaidGrowthHomeSearchPixelEvent,event_data:{search_results:(A||[]).map(Number),search_results_str:A||[],remarketing_ids:(E||[]).map(Number),remarketing_ids_str:E||[],subtab:2,device_id:(0,o.getBev)()||'',user_id:f.default.current().idStr,checkin_date:D.checkin,checkout_date:D.checkout,guests:D.guests||1,adults:D.adults||1,children:D.children,infants:D.infants,pets:D.amenities&&D.amenities.includes(12),instant_book:D.ib,price_min:D.price_min,price_max:D.price_max,room_types:D.room_types?D.room_types.map((t=>'Entire home/apt'===t?3:'Private room'===t?2:'Shared room'===t?1:3)):void 0,beds:D.min_beds,bedrooms:D.min_bedrooms,bathrooms:D.min_bathrooms,amenities:D.amenities,audience_type:N.audience_type,custom_data:t}})}catch(t){}}function b(t){return(0,l.initRemarketingDataV2)({userId:f.default.current()?.idStr,bevId:(0,o.getBev)(),userDataFields:['AUDIENCE_TYPE']}).then((n=>{n&&n?.userData?.audienceType!==v&&I(t,{event_id:n.event_id,audience_type:n?.userData?.audienceType,audienceType:n?.userData?.audienceType})}))}}),"26b25a",["45f788","ba7a76","af12d7","862e50","b4aab0","4c8c74","c1f92a","1949a1","387550","c8b97a","c235f8","06a99e"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=t(r(d[1])),l=t(r(d[2])),c=r(d[3]),n=t(r(d[4])),u=r(d[5]),s=t(r(d[6]));const f=n.default.format('rails_format'),h='YYYY-MM-DD',_='YYYY-MM-DD';e.default={localizedToCriteoDate:t=>t?(0,o.default)(t,f).format('MM/DD/YYYY'):'',localizedToGoogleDate:t=>t?(0,o.default)(t,h,!0).isValid()?t:(0,o.default)(t,f).format(h):'',hasAccount:()=>null!=s.default.current().idStr||!!(0,u.getCookieSync)('hli').value,makeGoogleDynxParams(t,o,l,c){return{hrental_pagetype:t,hrental_id:o,hrental_startdate:this.localizedToGoogleDate(l),hrental_enddate:this.localizedToGoogleDate(c),has_account:this.hasAccount()}},saveSearchFilters(t){if(!t.checkin||!t.checkout)return;const n=(0,o.default)(t.checkin,_,!0).isValid()?(0,o.default)(t.checkin,_):(0,o.default)(t.checkin,f),u=(0,o.default)(t.checkout,_,!0).isValid()?(0,o.default)(t.checkout,_):(0,o.default)(t.checkout,f),s=t.guests?String(t.guests):'',h=t.adults?String(t.adults):'',Y=t.children?String(t.children):'',k=t.infants?String(t.infants):'';let D=0;if(t.room_types)for(let o=0;o<t.room_types.length;o+=1){const l=t.room_types[o];'Entire home/apt'===l?D+=1:'Private room'===l?D+=2:'Shared room'===l&&(D+=4)}(0,l.default)('lsf',n.format(_).concat(',',u.format(_),',',s,',',h,',',Y,',',k,',',String(D)),{expires:n.diff((0,o.default)(),'days')+1,path:'/',domain:(0,c.getCookieHost)()})}}}),"387550",["ba7a76","1772c9","e7272f","5b85ba","30735e","13babd","06a99e"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.getDataLayerVariables=async function(t){const o=JSON.stringify(t);let c=l(o);(0,n.airdogCount)('gtm.getdatalayervars.cache',1,{cache_result:c?'hit':'miss',has_user_id:Boolean(t.userId),has_bev_id:Boolean(t.bevId),has_listing_id:Boolean(t.listingId),has_stay_confirmation_code:Boolean(t.stayConfirmationCode),has_experience_id:Boolean(t.experienceId),has_experience_confirmation_code:Boolean(t.experienceConfirmationCode),has_is_active_host:t.userDataFields?.includes('IS_ACTIVE_HOST')??!0,has_audience_type:t.userDataFields?.includes('AUDIENCE_TYPE')??!0,has_advanced_matching_data:t.userDataFields?.includes('ADVANCED_MATCHING_DATA')??!0,has_experience_audience_type:t.userDataFields?.includes('EXPERIENCE_AUDIENCE_TYPE')??!0,has_service_audience_type:t.userDataFields?.includes('SERVICE_AUDIENCE_TYPE')??!0}),c||(c=await s().default.post(`/api${_}`,{body:o}),E(o,c));return c};var n=r(d[1]);function s(){const n=t(r(d[2]));return s=function(){return n},n}var o=r(d[3]);const c=864e5,_="/v2/get-data-layer-variables";function u(t){return`${_}/${t.replace(/([^a-z0-9]+)/gi,'-')}`}function l(t){const n=u(t);return(0,o.localStorageGetItem)(n)}function E(t,n){const s=u(t);(0,o.localStorageSetItem)(s,n,{expires:c})}}),"858066",["ba7a76","3e4681","69a7c4","13babd"]);
__d((function(g,r,i,a,m,e,d){'use strict';Object.defineProperty(e,"__esModule",{value:!0});var t=e.PaidGrowthHomeSearchPixelEvent={defaultProps:{schema:'com.airbnb.jitney.event.logging.PaidGrowth:PaidGrowthHomeSearchPixelEvent:4.0.0',event_name:'paidgrowth_home_search_pixel',operation:20},propTypes:{}};t.fullyQualifiedName='PaidGrowth.v4.PaidGrowthHomeSearchPixelEvent';e.PaidGrowthHomeSearchPixelEventEvent=function(o){return{eventData:o,eventDataSchema:t}}}),"af12d7",[]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(d[1]),c=r(d[2]),s=r(d[3]),o=r(d[4]),u=r(d[5]),E=r(d[6]),l=t(r(d[7]));function f(t){switch(t){case c.EXPLORE_TABS.SELECT_HOMES:case c.EXPLORE_TABS.HOMES:case c.EXPLORE_TABS.LUXURY:return'homes';case c.EXPLORE_TABS.EXPERIENCES:case c.EXPLORE_TABS.ADVENTURES:return'experiences';default:return null}}e.default=function(t){const{remarketingIds:c,canonicalLocation:p,city:h,state:R,country:_}=t,y=(0,l.default)(),{checkin:P,checkout:S,adults:T,children:k,infants:L,pets:v,category_tag:O}=y,X=(0,n.useRef)(y);X.current=y;const{abort:A,scheduler:B}=(0,E.usePostTaskScheduler)({priority:'background',strategy:'recycle'});return(0,n.useEffect)((()=>{const t=(0,s.getTabFromRefinementPaths)(X.current.refinement_paths),n={city:h??void 0,state:R??void 0,country:_??void 0};return'homes'===f(t)?B.postTask((()=>{(0,o.updateP2Remarketing)({canonicalLocation:p||'',filters:X.current,geography:n,listingIds:[],remarketingIds:c||void 0})})):'experiences'===f(t)&&B.postTask((()=>{(0,u.updateP2RemarketingExperience)({filters:X.current,geography:n})})),A}),[h,_,R,p,P,S,T,k,L,v,O,A,B]),null}}),"d31cce",["ba7a76","07aa1f","87916a","aea415","26b25a","dbc503","53bb4a","f98e43"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.updateP2RemarketingExperience=function({filters:t,geography:n}){const{checkin:c,checkout:f,adults:s,children:h,infants:o,refinement_paths:l}=t,y=l&&l[0]||'',p=y.split('/').pop();u({checkin:c||'',checkout:f||'',city:n?.city??'N/A',state:n?.state??'N/A',country:n?.country??'N/A',numOfAdults:s||1,numOfChildren:h||0,numOfInfants:o||0,refinementPath:y,refinement:p})};var n=t(r(d[1])),c=t(r(d[2]));function u({checkin:t,checkout:u,city:f,state:s,country:h,numOfAdults:o,numOfChildren:l,numOfInfants:y,refinementPath:p,refinement:O}){(0,c.default)({event:'searchExperiences',data:{user_country:n.default.country(),city:f,state:s,country:h,checkin:t,checkout:u,numOfAdults:o,numOfChildren:l,numOfInfants:y,refinementPath:p,refinement:O}}),(t||u)&&(0,c.default)({event:'searchExperiencesWithDates',data:{user_country:n.default.country()}})}}),"dbc503",["ba7a76","862e50","c1f92a"]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/frontend/stays-search/sections/client/StaysRemarketing/StaysRemarketing.8ac4a4b019.js.map